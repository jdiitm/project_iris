%% =============================================================================
%% Erlang Distribution SSL Configuration
%% =============================================================================
%% This file configures TLS for Erlang distribution (inter-node communication).
%% Used with: erl -proto_dist inet_tls -ssl_dist_optfile /path/to/ssl_dist.conf
%%
%% RFC Reference: NFR-15 (All inter-node communication uses mutual TLS)
%% =============================================================================

[
  %% Server-side options (listening socket)
  {server, [
    {certfile, "/app/certs/node.pem"},
    {keyfile, "/app/certs/node-key.pem"},
    {cacertfile, "/app/certs/ca.pem"},
    {verify, verify_peer},
    {fail_if_no_peer_cert, true},
    {secure_renegotiate, true},
    {versions, ['tlsv1.2', 'tlsv1.3']}
  ]},
  
  %% Client-side options (connecting to other nodes)
  {client, [
    {certfile, "/app/certs/node.pem"},
    {keyfile, "/app/certs/node-key.pem"},
    {cacertfile, "/app/certs/ca.pem"},
    {verify, verify_peer},
    {secure_renegotiate, true},
    {versions, ['tlsv1.2', 'tlsv1.3']}
  ]}
].
